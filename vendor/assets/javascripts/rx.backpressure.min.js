(function(t){var e={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},n=e[typeof window]&&window||this,r=e[typeof exports]&&exports&&!exports.nodeType&&exports,i=e[typeof module]&&module&&!module.nodeType&&module,o=(i&&i.exports===r&&r,e[typeof global]&&global);!o||o.global!==o&&o.window!==o||(n=o),"function"==typeof define&&define.amd?define(["rx","exports"],function(e,r){return n.Rx=t(n,r,e),n.Rx}):"object"==typeof module&&module&&module.exports===r?module.exports=t(n,module.exports,require("./rx")):n.Rx=t(n,{},n.Rx)}).call(this,function(t,e,n){function r(){if(this.isDisposed)throw Error(v)}function i(t){return t}function o(t,e,n){return new c(function(r){function o(t,e){l[e]=t;var o;if(u[e]=!0,c||(c=u.every(i))){try{o=n.apply(null,l)}catch(s){return r.onError(s),undefined}r.onNext(o)}else h&&r.onCompleted()}var s=2,u=[!1,!1],c=!1,h=!1,l=Array(s);return new a(t.subscribe(function(t){o(t,0)},r.onError.bind(r),function(){h=!0,r.onCompleted()}),e.subscribe(function(t){o(t,1)},r.onError.bind(r)))})}var s=n.Observable,u=s.prototype,c=n.AnonymousObservable,a=n.CompositeDisposable,h=n.Subject,l=n.Observer,f=n.Disposable.empty,p=n.Disposable.create,d=n.internals.inherits,b=n.internals.addProperties;n.Scheduler.timeout;var v="Object has been disposed";u.pausable=function(t){var e=this;return new c(function(n){var r=e.publish(),i=r.subscribe(n),o=f,s=t.distinctUntilChanged().subscribe(function(t){t?o=r.connect():(o.dispose(),o=f)});return new a(i,o,s)})},u.pausableBuffered=function(t){var e=this;return new c(function(n){var r=[],i=!0,s=o(e,t.distinctUntilChanged(),function(t,e){return{data:t,shouldFire:e}}).subscribe(function(t){if(t.shouldFire&&i&&n.onNext(t.data),t.shouldFire&&!i){for(;r.length>0;)n.onNext(r.shift());i=!0}else t.shouldFire||i?!t.shouldFire&&i&&(i=!1):r.push(t.data)},n.onError.bind(n),n.onCompleted.bind(n));return t.onNext(!1),s})},u.controlled=function(t){return null==t&&(t=!0),new m(this,t)};var m=function(t){function e(t){return this.source.subscribe(t)}function n(n,r){t.call(this,e),this.subject=new y(r),this.source=n.multicast(this.subject).refCount()}return d(n,t),n.prototype.request=function(t){return null==t&&(t=-1),this.subject.request(t)},n}(s),y=n.ControlledSubject=function(t){function e(t){return this.subject.subscribe(t)}function n(n){null==n&&(n=!0),t.call(this,e),this.subject=new h,this.enableQueue=n,this.queue=n?[]:null,this.requestedCount=0,this.requestedDisposable=f,this.error=null,this.hasFailed=!1,this.hasCompleted=!1,this.controlledDisposable=f}return d(n,t),b(n.prototype,l,{onCompleted:function(){r.call(this),this.hasCompleted=!0,this.enableQueue&&0!==this.queue.length||this.subject.onCompleted()},onError:function(t){r.call(this),this.hasFailed=!0,this.error=t,this.enableQueue&&0!==this.queue.length||this.subject.onError(t)},onNext:function(t){r.call(this);var e=!1;0===this.requestedCount?this.enableQueue&&this.queue.push(t):(-1!==this.requestedCount&&0===this.requestedCount--&&this.disposeCurrentRequest(),e=!0),e&&this.subject.onNext(t)},_processRequest:function(t){if(this.enableQueue){for(;this.queue.length>=t&&t>0;)this.subject.onNext(this.queue.shift()),t--;return 0!==this.queue.length?{numberOfItems:t,returnValue:!0}:{numberOfItems:t,returnValue:!1}}return this.hasFailed?(this.subject.onError(this.error),this.controlledDisposable.dispose(),this.controlledDisposable=f):this.hasCompleted&&(this.subject.onCompleted(),this.controlledDisposable.dispose(),this.controlledDisposable=f),{numberOfItems:t,returnValue:!1}},request:function(t){r.call(this),this.disposeCurrentRequest();var e=this,n=this._processRequest(t);return t=n.numberOfItems,n.returnValue?f:(this.requestedCount=t,this.requestedDisposable=p(function(){e.requestedCount=0}),this.requestedDisposable)},disposeCurrentRequest:function(){this.requestedDisposable.dispose(),this.requestedDisposable=f},dispose:function(){this.isDisposed=!0,this.error=null,this.subject.dispose(),this.requestedDisposable.dispose()}}),n}(s);return n});