/* Copyright (c) Microsoft Open Technologies, Inc. All rights reserved. See License.txt in the project root for license information.*/
(function(a){var b={"function":!0,object:!0},c=b[typeof exports]&&exports&&!exports.nodeType&&exports,d=b[typeof self]&&self.Object&&self,e=b[typeof window]&&window&&window.Object&&window,f=b[typeof module]&&module&&!module.nodeType&&module,g=(f&&f.exports===c&&c,c&&f&&"object"==typeof global&&global&&global.Object&&global),h=h=g||e!==(this&&this.window)&&e||d||this;"function"==typeof define&&define.amd?define(["./rx.core"],function(b,c){return a(h,c,b)}):"object"==typeof module&&module&&module.exports===c?module.exports=a(h,module.exports,require("./rx.core")):h.Rx=a(h,{},h.Rx)}).call(this,function(a,b,c){function d(a){for(var b=a.length,c=new Array(b),d=0;b>d;d++)c[d]=a[d];return c}function e(){try{return h.apply(this,arguments)}catch(a){return w.e=a,w}}function f(a){if(!s(a))throw new TypeError("fn must be a function");return h=a,e}function g(a){throw a}var h,i=c.Observable,j=i.prototype,k=c.AnonymousObservable,l=c.Observer,m=c.internals.AbstractObserver,n=c.Disposable.create,o=c.Disposable.empty,p=c.CompositeDisposable,q=c.SerialDisposable,r=c.Scheduler.currentThread,s=c.helpers.isFunction,t=c.internals.inherits,u=c.internals.addProperties,v=c.Disposable.checkDisposed,w={e:{}};j.multicast=function(a,b){var c=this;return"function"==typeof a?new k(function(d){var e=c.multicast(a());return new p(b(e).subscribe(d),e.connect())},c):new E(c,a)},j.publish=function(a){return a&&s(a)?this.multicast(function(){return new z},a):this.multicast(new z)},j.share=function(){return this.publish().refCount()},j.publishLast=function(a){return a&&s(a)?this.multicast(function(){return new B},a):this.multicast(new B)},j.publishValue=function(a,b){return 2===arguments.length?this.multicast(function(){return new C(b)},a):this.multicast(new C(a))},j.shareValue=function(a){return this.publishValue(a).refCount()},j.replay=function(a,b,c,d){return a&&s(a)?this.multicast(function(){return new D(b,c,d)},a):this.multicast(new D(b,c,d))},j.shareReplay=function(a,b,c){return this.replay(null,a,b,c).refCount()};var x=c.internals.ScheduledObserver=function(a){function b(b,c){a.call(this),this.scheduler=b,this.observer=c,this.isAcquired=!1,this.hasFaulted=!1,this.queue=[],this.disposable=new q}return t(b,a),b.prototype.next=function(a){var b=this;this.queue.push(function(){b.observer.onNext(a)})},b.prototype.error=function(a){var b=this;this.queue.push(function(){b.observer.onError(a)})},b.prototype.completed=function(){var a=this;this.queue.push(function(){a.observer.onCompleted()})},b.prototype.ensureActive=function(){var a=!1;!this.hasFaulted&&this.queue.length>0&&(a=!this.isAcquired,this.isAcquired=!0),a&&this.disposable.setDisposable(this.scheduler.scheduleRecursiveWithState(this,function(a,b){var c;if(!(a.queue.length>0))return void(a.isAcquired=!1);c=a.queue.shift();var d=f(c)();return d===w?(a.queue=[],a.hasFaulted=!0,g(d.e)):void b(a)}))},b.prototype.dispose=function(){a.prototype.dispose.call(this),this.disposable.dispose()},b}(m),y=function(a,b){this.subject=a,this.observer=b};y.prototype.dispose=function(){if(!this.subject.isDisposed&&null!==this.observer){var a=this.subject.observers.indexOf(this.observer);this.subject.observers.splice(a,1),this.observer=null}};var z=c.Subject=function(a){function b(a){return v(this),this.isStopped?this.hasError?(a.onError(this.error),o):(a.onCompleted(),o):(this.observers.push(a),new y(this,a))}function c(){a.call(this,b),this.isDisposed=!1,this.isStopped=!1,this.observers=[],this.hasError=!1}return t(c,a),u(c.prototype,l.prototype,{hasObservers:function(){return this.observers.length>0},onCompleted:function(){if(v(this),!this.isStopped){this.isStopped=!0;for(var a=0,b=d(this.observers),c=b.length;c>a;a++)b[a].onCompleted();this.observers.length=0}},onError:function(a){if(v(this),!this.isStopped){this.isStopped=!0,this.error=a,this.hasError=!0;for(var b=0,c=d(this.observers),e=c.length;e>b;b++)c[b].onError(a);this.observers.length=0}},onNext:function(a){if(v(this),!this.isStopped)for(var b=0,c=d(this.observers),e=c.length;e>b;b++)c[b].onNext(a)},dispose:function(){this.isDisposed=!0,this.observers=null}}),c.create=function(a,b){return new A(a,b)},c}(i),A=c.AnonymousSubject=function(a){function b(a){return this.observable.subscribe(a)}function c(c,d){this.observer=c,this.observable=d,a.call(this,b)}return t(c,a),u(c.prototype,l.prototype,{onCompleted:function(){this.observer.onCompleted()},onError:function(a){this.observer.onError(a)},onNext:function(a){this.observer.onNext(a)}}),c}(i),B=c.AsyncSubject=function(a){function b(a){return v(this),this.isStopped?(this.hasError?a.onError(this.error):this.hasValue?(a.onNext(this.value),a.onCompleted()):a.onCompleted(),o):(this.observers.push(a),new y(this,a))}function c(){a.call(this,b),this.isDisposed=!1,this.isStopped=!1,this.hasValue=!1,this.observers=[],this.hasError=!1}return t(c,a),u(c.prototype,l,{hasObservers:function(){return v(this),this.observers.length>0},onCompleted:function(){var a,b;if(v(this),!this.isStopped){this.isStopped=!0;var c=d(this.observers),b=c.length;if(this.hasValue)for(a=0;b>a;a++){var e=c[a];e.onNext(this.value),e.onCompleted()}else for(a=0;b>a;a++)c[a].onCompleted();this.observers.length=0}},onError:function(a){if(v(this),!this.isStopped){this.isStopped=!0,this.hasError=!0,this.error=a;for(var b=0,c=d(this.observers),e=c.length;e>b;b++)c[b].onError(a);this.observers.length=0}},onNext:function(a){v(this),this.isStopped||(this.value=a,this.hasValue=!0)},dispose:function(){this.isDisposed=!0,this.observers=null,this.exception=null,this.value=null}}),c}(i),C=c.BehaviorSubject=function(a){function b(a){return v(this),this.isStopped?(this.hasError?a.onError(this.error):a.onCompleted(),o):(this.observers.push(a),a.onNext(this.value),new y(this,a))}function c(c){a.call(this,b),this.value=c,this.observers=[],this.isDisposed=!1,this.isStopped=!1,this.hasError=!1}return t(c,a),u(c.prototype,l,{getValue:function(){if(v(this),this.hasError)throw this.error;return this.value},hasObservers:function(){return this.observers.length>0},onCompleted:function(){if(v(this),!this.isStopped){this.isStopped=!0;for(var a=0,b=d(this.observers),c=b.length;c>a;a++)b[a].onCompleted();this.observers.length=0}},onError:function(a){if(v(this),!this.isStopped){this.isStopped=!0,this.hasError=!0,this.error=a;for(var b=0,c=d(this.observers),e=c.length;e>b;b++)c[b].onError(a);this.observers.length=0}},onNext:function(a){if(v(this),!this.isStopped){this.value=a;for(var b=0,c=d(this.observers),e=c.length;e>b;b++)c[b].onNext(a)}},dispose:function(){this.isDisposed=!0,this.observers=null,this.value=null,this.exception=null}}),c}(i),D=c.ReplaySubject=function(a){function b(a,b){return n(function(){b.dispose(),!a.isDisposed&&a.observers.splice(a.observers.indexOf(b),1)})}function c(a){var c=new x(this.scheduler,a),d=b(this,c);v(this),this._trim(this.scheduler.now()),this.observers.push(c);for(var e=0,f=this.q.length;f>e;e++)c.onNext(this.q[e].value);return this.hasError?c.onError(this.error):this.isStopped&&c.onCompleted(),c.ensureActive(),d}function e(b,d,e){this.bufferSize=null==b?f:b,this.windowSize=null==d?f:d,this.scheduler=e||r,this.q=[],this.observers=[],this.isStopped=!1,this.isDisposed=!1,this.hasError=!1,this.error=null,a.call(this,c)}var f=Math.pow(2,53)-1;return t(e,a),u(e.prototype,l.prototype,{hasObservers:function(){return this.observers.length>0},_trim:function(a){for(;this.q.length>this.bufferSize;)this.q.shift();for(;this.q.length>0&&a-this.q[0].interval>this.windowSize;)this.q.shift()},onNext:function(a){if(v(this),!this.isStopped){var b=this.scheduler.now();this.q.push({interval:b,value:a}),this._trim(b);for(var c=0,e=d(this.observers),f=e.length;f>c;c++){var g=e[c];g.onNext(a),g.ensureActive()}}},onError:function(a){if(v(this),!this.isStopped){this.isStopped=!0,this.error=a,this.hasError=!0;var b=this.scheduler.now();this._trim(b);for(var c=0,e=d(this.observers),f=e.length;f>c;c++){var g=e[c];g.onError(a),g.ensureActive()}this.observers.length=0}},onCompleted:function(){if(v(this),!this.isStopped){this.isStopped=!0;var a=this.scheduler.now();this._trim(a);for(var b=0,c=d(this.observers),e=c.length;e>b;b++){var f=c[b];f.onCompleted(),f.ensureActive()}this.observers.length=0}},dispose:function(){this.isDisposed=!0,this.observers=null}}),e}(i),E=c.ConnectableObservable=function(a){function b(b,c){var d,e=!1,f=b.asObservable();this.connect=function(){return e||(e=!0,d=new p(f.subscribe(c),n(function(){e=!1}))),d},a.call(this,function(a){return c.subscribe(a)})}return t(b,a),b.prototype.refCount=function(){var a,b=0,c=this;return new k(function(d){var e=1===++b,f=c.subscribe(d);return e&&(a=c.connect()),function(){f.dispose(),0===--b&&a.dispose()}})},b}(i);return c});
//# sourceMappingURL=rx.core.binding.map